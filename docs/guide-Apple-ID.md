---
title: Apple-ID fixing
---
 
[Video guide here](https://www.youtube.com/watch?v=vBRrCYZEjtI) (Use SMBIOS iMacPro1,1)

1. Modify the MAC adress. You can use a random multicast [MAC address generator](https://www.hellion.org.uk/cgi-bin/randmac.pl).
 - With the `basic.sh` script, just edit the script and modify the MAC address (search for "mac=").
 - With virt-manager, paste it into the template generated by `make.sh`. While I was editing the template, I also used `uuidgen` and pasted that in there for good measure. Then import the template with `virsh define whatever.xml`.

2. In the macOS Finder, look for **EFI** in the left bar under **Volumes**. If it isn't visible you will have to mount it:
 - Open the macOS Terminal and type `diskutil list` and look for the disk/partition location of the EFI. (There may be more than one.)
 - Type `sudo diskutil mount diskYsZ`, using the disk/partition location name where you see EFI. It should look like this:
 ![image](https://oneclick-macos-simple-kvm.notaperson535.is-a.dev/img/efi%20partition.png)
3. Download [GenSMBIOS](https://github.com/corpnewt/GenSMBIOS) and generate a set of serials for the mac model shown under "System Report" ("iMacPro1,1").
4. Locate the plist file at `/Volumes/EFI/OC/config.plist`. Insert the generated serials into generic section in the appropriate places.

| GenSMBIOS Value | config.plist       |
| --------------- | ------------------ | 
| Type            | SystemProductName  | 
| Serial          | SystemSerialNumber |
| Board Serial    | MLB                |
| SmUUID          | SystemUUID         |

5. You can edit it by hand or use [ProperTree](https://github.com/corpnewt/ProperTree) for this.
6. *Sequoia only* In this version, it seems macOS detect the VM and "block" the apple ID. You have to trick macOS the disable the flag "hv_vmm_present". And you can force the flag to 0 by modifing the `config.plist` file, by adding this:
```
    <dict>
        ...
        <key>Kernel</key>
        <dict>
            ...
            <key>Patch</key>
            <array>
                ...
                <dict>
                    <key>Arch</key>
                    <string>x86_64</string>
                    <key>Base</key>
                    <string></string>
                    <key>Comment</key>
                    <string>Patch kern.hv_vmm_present=0 - PART 1 of 2</string>
                    <key>Count</key>
                    <integer>1</integer>
                    <key>Enabled</key>
                    <true/>
                    <key>Find</key>
                    <data>aGliZXJuYXRlaGlkcmVhZHkAaGliZXJuYXRlY291bnQA</data>
                    <key>Identifier</key>
                    <string>kernel</string>
                    <key>Limit</key>
                    <integer>0</integer>
                    <key>Mask</key>
                    <data></data>
                    <key>MaxKernel</key>
                    <string></string>
                    <key>MinKernel</key>
                    <string>20.4.0</string>
                    <key>Replace</key>
                    <data>aGliZXJuYXRlaGlkcmVhZHkAaHZfdm1tX3ByZXNlbnQA</data>
                    <key>ReplaceMask</key>
                    <data></data>
                    <key>Skip</key>
                    <integer>0</integer>
                </dict>
                <dict>
                    <key>Arch</key>
                    <string>x86_64</string>
                    <key>Base</key>
                    <string></string>
                    <key>Comment</key>
                    <string>Patch kern.hv_vmm_present=0 - PART 2 of 2</string>
                    <key>Count</key>
                    <integer>1</integer>
                    <key>Enabled</key>
                    <true/>
                    <key>Find</key>
                    <data>Ym9vdCBzZXNzaW9uIFVVSUQAaHZfdm1tX3ByZXNlbnQA</data>
                    <key>Identifier</key>
                    <string>kernel</string>
                    <key>Limit</key>
                    <integer>0</integer>
                    <key>Mask</key>
                    <data></data>
                    <key>MaxKernel</key>
                    <string></string>
                    <key>MinKernel</key>
                    <string>22.0.0</string>
                    <key>Replace</key>
                    <data>Ym9vdCBzZXNzaW9uIFVVSUQAaGliZXJuYXRlY291bnQA</data>
                    <key>ReplaceMask</key>
                    <data></data>
                    <key>Skip</key>
                    <integer>0</integer>
                </dict>
                ...
```
(source https://forum.proxmox.com/threads/anyone-can-make-bluetooth-work-on-sonoma.153301/#post-697832)

7. Reboot. On Sequoia, if the manipulation of the `config.plist` worked correctly, you should see the flag `hv_vmm_present` set to 0 with the command `sysctl kern | grep 'kern.hv_vmm_present'`
8. You should be able to log in with your Apple-ID now.
